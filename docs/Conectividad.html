<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Murillo">

<title>Conectividad ecológica</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Conectividad_files/libs/clipboard/clipboard.min.js"></script>
<script src="Conectividad_files/libs/quarto-html/quarto.js"></script>
<script src="Conectividad_files/libs/quarto-html/popper.min.js"></script>
<script src="Conectividad_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Conectividad_files/libs/quarto-html/anchor.min.js"></script>
<link href="Conectividad_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Conectividad_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Conectividad_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Conectividad_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Conectividad_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Conectividad ecológica</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Murillo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>La conectividad es un concepto central en ecología y conservación. Se refiere a cómo el paisaje facilita o impide el movimiento de organismos, genes, agua, nutrientes y energía entre diferentes hábitats.</p>
<ul>
<li><p>Conectividad ecológica describe la capacidad de los organismos para moverse libremente por el paisaje. Esta puede ser estructural (basada en la continuidad física de los hábitats, como corredores o parches conectados) o funcional (basada en el comportamiento de las especies, su capacidad de atravesar diferentes tipos de hábitat).</p></li>
<li><p>Conectividad genética, por otro lado, se refiere al intercambio de genes entre poblaciones a través del movimiento de individuos reproductores. La conectividad genética es vital para mantener la diversidad genética, evitar la endogamia y permitir la adaptación evolutiva a largo plazo.</p></li>
</ul>
<p>Aunque relacionadas, conectividad ecológica y genética no siempre son equivalentes: un paisaje puede parecer conectado físicamente, pero no garantizar suficiente flujo genético si las especies no logran reproducirse tras moverse.</p>
<p>Entender y gestionar ambos tipos de conectividad es crucial para diseñar estrategias efectivas de conservación, especialmente en paisajes fragmentados por actividades humanas.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Conectividad del paisaje - landscapemetrics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Conectividad ecológica - Makurhini</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Grainscape</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>La conectividad del paisaje es un concepto fundamental en ecología del paisaje y conservación biológica, ya que describe cómo las características espaciales del entorno facilitan o restringen el movimiento de organismos entre hábitats adecuados. Una alta conectividad puede mejorar la dispersión, la colonización, la reproducción y la persistencia de las poblaciones, mientras que una baja conectividad puede aumentar el aislamiento y el riesgo de extinción local.</p>
<p>En R, el paquete <code>landscapemetrics</code> proporciona una serie de herramientas para cuantificar métricas espaciales a partir de mapas raster categóricos (por ejemplo, uso del suelo o cobertura vegetal). Estas métricas permiten evaluar la estructura y conectividad del paisaje desde una perspectiva cuantitativa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(landscapemetrics)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Yoro <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">"data/ClasificacionYoro.tif"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_landscape</span>(Yoro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  layer       crs units   class n_classes OK
1     1 projected     m integer         6  ✔</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Conectividad de parche</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Distancia Euclidiana al Parche Más Cercano</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Agregación a nivel de clase</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Índice de Aglomeración</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Índice de Cohesión del Parche</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">Índice de Agregación</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>La métrica lsm_p_contig() (Índice de contigüidad, o contiguity index) del paquete landscapemetrics es una métrica de forma a nivel de parche, y su propósito principal es cuantificar qué tan compacto o conectado internamente está un parche de hábitat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lsm</span>(Yoro, <span class="at">what =</span> <span class="st">"lsm_p_contig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31,109 × 6
   layer level class    id metric value
   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
 1     1 patch     1     1 contig 0    
 2     1 patch     1     2 contig 0    
 3     1 patch     1     3 contig 0.667
 4     1 patch     1     4 contig 0.354
 5     1 patch     1     5 contig 0    
 6     1 patch     1     6 contig 0    
 7     1 patch     1     7 contig 0    
 8     1 patch     1     8 contig 0.623
 9     1 patch     1     9 contig 0.278
10     1 patch     1    10 contig 0.333
# ℹ 31,099 more rows</code></pre>
</div>
</div>
<p>Evaluar la forma interna de los parches: Indica cuán contiguas (es decir, agrupadas y sin perforaciones o ramificaciones) están las celdas dentro de un parche.</p>
<p>Identificar parches bien conectados internamente:</p>
<ul>
<li><p>Valores altos de CONTIG indican que las celdas de un parche están fuertemente conectadas, formando formas más compactas o cuadradas.</p></li>
<li><p>Valores bajos indican formas más alargadas, fragmentadas o ramificadas internamente.</p></li>
</ul>
<p>Aplicaciones ecológicas:</p>
<ul>
<li><p>Evaluar calidad del hábitat: Parches con mayor contigüidad pueden ofrecer condiciones más estables y seguras para ciertas especies (p.&nbsp;ej., menos borde).</p></li>
<li><p>Medir susceptibilidad a fragmentación: Parches con baja contigüidad podrían fragmentarse más fácilmente con pequeñas perturbaciones.</p></li>
<li><p>Comparar estructura interna del hábitat en diferentes paisajes o a lo largo del tiempo.</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>La métrica lsm_p_enn() (Euclidean Nearest-Neighbor Distance, o Distancia Euclidiana al Parche Más Cercano) es una métrica de agregación a nivel de parche, y se utiliza para cuantificar el aislamiento espacial de cada parche con respecto a otros parches de la misma clase de cobertura (por ejemplo, bosque con respecto a otros parches de bosque).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lsm</span>(Yoro, <span class="at">what =</span> <span class="st">"lsm_p_enn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31,109 × 6
   layer level class    id metric    value
   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;
 1     1 patch     1     1 enn    0.00181 
 2     1 patch     1     2 enn    0.00243 
 3     1 patch     1     3 enn    0.00243 
 4     1 patch     1     4 enn    0.000603
 5     1 patch     1     5 enn    0.00286 
 6     1 patch     1     6 enn    0.00422 
 7     1 patch     1     7 enn    0.000603
 8     1 patch     1     8 enn    0.000539
 9     1 patch     1     9 enn    0.000603
10     1 patch     1    10 enn    0.000603
# ℹ 31,099 more rows</code></pre>
</div>
</div>
<p>¿Para qué es útil la métrica ENN?</p>
<p>Medir el aislamiento de los parches:</p>
<p>Calcula la distancia más corta (borde a borde) desde un parche hasta el parche más cercano de la misma clase.</p>
<p>ENN bajo: el parche está cerca de otros parches similares (alta agregación).</p>
<p>ENN alto: el parche está aislado (baja conectividad estructural).</p>
<p>Aplicaciones ecológicas:</p>
<p>Evaluar conectividad estructural entre hábitats similares.</p>
<p>Identificar parches críticos o vulnerables por aislamiento.</p>
<p>Diseño de corredores para facilitar la dispersión entre parches.</p>
<p>Seguimiento del efecto de la fragmentación del hábitat a lo largo del tiempo.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>La métrica lsm_c_ai() corresponde al Índice de Agregación (Aggregation Index, AI) a nivel de clase, y es una métrica muy útil para cuantificar qué tan agrupados (o dispersos) están los parches de una clase de cobertura específica (por ejemplo, bosque, pastizal, cultivo) en un paisaje.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lsm</span>(Yoro, <span class="at">what =</span> <span class="st">"lsm_c_ai"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  layer level class    id metric value
  &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
1     1 class     1    NA ai      49.3
2     1 class     2    NA ai      51.8
3     1 class     3    NA ai      19.0
4     1 class     4    NA ai      50.7
5     1 class     5    NA ai      86.2
6     1 class     6    NA ai      57.0</code></pre>
</div>
</div>
<p>¿Para qué es útil el Aggregation Index (AI)?</p>
<p>Evalúa la proximidad y contigüidad de celdas que pertenecen a una misma clase.</p>
<p>Permite comparar cómo de agregados están los parches de una categoría en diferentes paisajes o escenarios (e.g., antes y después de la deforestación).</p>
<p>Es útil para estudios de fragmentación, planificación de conectividad ecológica y gestión del uso del suelo.</p>
<p>¿Cómo se interpreta?</p>
<p>El resultado se expresa en porcentaje (0 a 100).</p>
<p>≈ 0 La clase está totalmente fragmentada o dispersa ≈ 100 La clase está totalmente agregada o continua</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>La métrica lsm_c_clumpy() corresponde al Índice de Aglomeración (Clumpiness Index, CLUMPY) a nivel de clase, y es una de las métricas más robustas para evaluar la estructura espacial de la agregación de una clase de cobertura en el paisaje.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lsm</span>(Yoro, <span class="at">what =</span> <span class="st">"lsm_c_clumpy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  layer level class    id metric value
  &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
1     1 class     1    NA clumpy 0.485
2     1 class     2    NA clumpy 0.426
3     1 class     3    NA clumpy 0.175
4     1 class     4    NA clumpy 0.473
5     1 class     5    NA clumpy 0.634
6     1 class     6    NA clumpy 0.511</code></pre>
</div>
</div>
<p>¿Qué mide CLUMPY?</p>
<p>CLUMPY mide qué tan agrupadas están las celdas de una clase (por ejemplo, bosque, cultivo, pastizal) comparado con una distribución aleatoria. A diferencia del AI, CLUMPY toma en cuenta el área total ocupada por la clase, lo que permite comparaciones más estandarizadas entre clases.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>Valor CLUMPY</th>
<th>Interpretación</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>= 1</strong></td>
<td>Máxima agregación posible (todas las celdas están juntas)</td>
</tr>
<tr class="even">
<td><strong>≈ 0</strong></td>
<td>Distribución aleatoria</td>
</tr>
<tr class="odd">
<td><strong>= -1</strong></td>
<td>Máxima disgregación (la clase está completamente dispersa)</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>La métrica lsm_c_cohesion() mide el Índice de Cohesión del Parche (Patch Cohesion Index, COHESION) a nivel de clase y se utiliza para cuantificar la conectividad física de los parches de una clase en el paisaje.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lsm</span>(Yoro, <span class="at">what =</span> <span class="st">"lsm_c_cohesion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  layer level class    id metric   value
  &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
1     1 class     1    NA cohesion  75.0
2     1 class     2    NA cohesion  93.5
3     1 class     3    NA cohesion  37.9
4     1 class     4    NA cohesion  78.8
5     1 class     5    NA cohesion  99.9
6     1 class     6    NA cohesion  90.2</code></pre>
</div>
</div>
<p>¿Qué mide COHESION?</p>
<p>COHESION evalúa qué tan físicamente conectados están los parches de una clase. No mide solamente cuán cercanos o adyacentes están, sino cuánto contribuye su forma y tamaño a mantener la clase conectada. Es sensible a la configuración espacial y a la fragmentación del paisaje.</p>
<p>Rango e interpretación</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>Valor de COHESION</th>
<th>Interpretación</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cercano a <strong>0</strong></td>
<td>Los parches están altamente fragmentados y aislados</td>
</tr>
<tr class="even">
<td>Cercano a <strong>100</strong></td>
<td>Los parches están altamente conectados (más cohesivos)</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<p>La métrica lsm_l_ai() calcula el Índice de Agregación (Aggregation Index, AI) a nivel de paisaje completo (landscape level) y es otra métrica que describe la configuración espacial de las clases en el paisaje, específicamente cuán agrupadas o dispersas están las celdas de cada clase.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lsm</span>(Yoro, <span class="at">what =</span> <span class="st">"lsm_l_ai"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  layer level     class    id metric value
  &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
1     1 landscape    NA    NA ai      73.2</code></pre>
</div>
</div>
<p>¿Qué mide AI?</p>
<p>El Índice de Agregación (AI) mide la frecuencia con que las celdas de la misma clase están adyacentes entre sí, en relación con el número máximo teórico de adyacencias posibles para esa clase. Es un indicador general del grado de agrupamiento de las clases en el paisaje.</p>
<p>Rango e interpretación</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th>Valor de AI</th>
<th>Interpretación</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>0</strong></td>
<td>Máxima desagregación (celdas de la clase muy dispersas)</td>
</tr>
<tr class="even">
<td><strong>100</strong></td>
<td>Máxima agregación (celdas de la clase muy agrupadas)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><a href="https://connectscape.github.io/Makurhini/">Makurhini</a> es un paquete de R diseñado para facilitar el análisis detallado de fragmentación y conectividad del paisaje, dos procesos clave en la conservación de la biodiversidad. El nombre Makurhini proviene de una palabra indígena purépecha que significa “camino” o “conexión”, reflejando el enfoque del paquete en los flujos ecológicos entre fragmentos de hábitat.</p>
<p>Makurhini permite:</p>
<ul>
<li><p>Calcular métricas de conectividad tanto estructural (basada en la disposición física del paisaje) como funcional (considerando el movimiento de especies según distancias o resistencias).</p></li>
<li><p>Estimar índices como el Probability of Connectivity (PC), Integral Index of Connectivity (IIC), flux y otros indicadores que miden la importancia de fragmentos, la cantidad de hábitat disponible y los cambios en conectividad a través del tiempo.</p></li>
<li><p>Trabajar con análisis de escenarios, optimización de redes de conservación y comparaciones entre múltiples paisajes.</p></li>
</ul>
<p>El paquete integra capacidades de procesamiento espacial avanzadas usando terra y sf, y está diseñado para trabajar de forma flexible con grandes conjuntos de datos.</p>
<p>¿Para qué sirve?</p>
<ul>
<li><p>Evaluar el impacto de la fragmentación sobre especies.</p></li>
<li><p>Priorizar áreas para restauración o conservación basadas en su contribución a la conectividad.</p></li>
<li><p>Comparar escenarios de cambio de paisaje (por ejemplo, deforestación, expansión urbana).</p></li>
</ul>
<p><a href="https://doi.org/10.21203/rs.3.rs-6398746/v1">Makurhini: An R package for comprehensive analysis of landscape fragmentation and connectivity</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(remotes)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install_github("connectscape/Makurhini", dependencies = TRUE)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Makurhini)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geodata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Midata <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"data/Cobertura boscosa/n2402vA001995_HN.shp"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>BosqueMixto <span class="ot">&lt;-</span> Midata <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DEFINICION <span class="sc">==</span> <span class="st">"Bosque mixto"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">row_number</span>(), </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Area)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>nodes_ready <span class="ot">&lt;-</span> <span class="fu">nodesfile</span>(BosqueMixto, <span class="at">area_unit =</span> <span class="st">"m2"</span>, <span class="at">id =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>MK_dPCIIC</code> calcula el índice dPC (delta Probability of Connectivity) o sus componentes (intra, flux, connector) para múltiples umbrales de distancia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>PC_BM <span class="ot">&lt;-</span> <span class="fu">MK_dPCIIC</span>(<span class="at">nodes =</span> BosqueMixto, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">attribute =</span> <span class="cn">NULL</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">distance =</span><span class="fu">list</span>(<span class="at">type =</span> <span class="st">"centroid"</span>),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">parallel =</span> <span class="cn">NULL</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">"PC"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">probability =</span> <span class="fl">0.5</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">area_unit =</span> <span class="st">"m2"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">distance_thresholds =</span> <span class="fu">c</span>(<span class="dv">250</span>, <span class="dv">1500</span>, <span class="dv">5000</span>, <span class="dv">20000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Estimating PC index. This may take several minutes depending on the number of nodes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■                      36% |  ETA:  3s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |==================                                                    |  25%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■               61% |  ETA:  2s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |===================================                                   |  50%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■■■■      91% |  ETA:  0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |====================================================                  |  75%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■                      38% |  ETA:  3s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PC_BM<span class="sc">$</span>d20000[<span class="st">"dPC"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Conectividad_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PC_BM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$d250
Simple feature collection with 253 features and 6 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 261736.6 ymin: 1466378 xmax: 800995.8 ymax: 1826365
Projected CRS: WGS 84 / UTM zone 16N
First 10 features:
   ID               Area       dPC  dPCintra  dPCflux dPCconnector
1   1   173709.713 [m^2] 0.0000064 0.0000064 0.00e+00  0.00000e+00
2   2  1665924.073 [m^2] 0.0005941 0.0005921 1.90e-06  0.00000e+00
3   3  1031587.411 [m^2] 0.0002272 0.0002270 2.00e-07  0.00000e+00
4   4   261747.202 [m^2] 0.0000193 0.0000146 4.70e-06  1.47802e-15
5   5 12462507.334 [m^2] 0.0331374 0.0331374 0.00e+00  0.00000e+00
6   6   401677.773 [m^2] 0.0000378 0.0000344 3.40e-06  0.00000e+00
7   7  1390255.378 [m^2] 0.0004324 0.0004124 2.00e-05  0.00000e+00
8   8    60142.550 [m^2] 0.0000029 0.0000008 2.20e-06  0.00000e+00
9   9  1419086.185 [m^2] 0.0004513 0.0004297 2.16e-05  2.32334e-15
10 10     2818.298 [m^2] 0.0000002 0.0000000 2.00e-07  0.00000e+00
                         geometry
1  POLYGON ((623563.5 1825642,...
2  POLYGON ((613771.4 1818067,...
3  POLYGON ((617573.4 1818086,...
4  POLYGON ((615348.9 1816681,...
5  POLYGON ((576213 1816670, 5...
6  POLYGON ((614726.5 1815664,...
7  POLYGON ((567698.8 1812707,...
8  POLYGON ((567113.7 1811709,...
9  POLYGON ((566277.8 1812459,...
10 POLYGON ((566420.1 1812065,...

$d1500
Simple feature collection with 253 features and 6 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 261736.6 ymin: 1466378 xmax: 800995.8 ymax: 1826365
Projected CRS: WGS 84 / UTM zone 16N
First 10 features:
   ID               Area       dPC  dPCintra   dPCflux dPCconnector
1   1   173709.713 [m^2] 0.0000079 0.0000064 0.0000015 4.530500e-15
2   2  1665924.073 [m^2] 0.0009273 0.0005880 0.0003393 3.260200e-16
3   3  1031587.411 [m^2] 0.0004629 0.0002255 0.0002374 8.286720e-15
4   4   261747.202 [m^2] 0.0001604 0.0000145 0.0001458 4.600760e-15
5   5 12462507.334 [m^2] 0.0341744 0.0329064 0.0012679 4.690300e-16
6   6   401677.773 [m^2] 0.0001905 0.0000342 0.0001563 1.005600e-16
7   7  1390255.378 [m^2] 0.0016727 0.0004095 0.0012632 3.195580e-15
8   8    60142.550 [m^2] 0.0000563 0.0000008 0.0000555 5.448900e-16
9   9  1419086.185 [m^2] 0.0013481 0.0004267 0.0009214 8.119920e-15
10 10     2818.298 [m^2] 0.0000026 0.0000000 0.0000026 1.021174e-14
                         geometry
1  POLYGON ((623563.5 1825642,...
2  POLYGON ((613771.4 1818067,...
3  POLYGON ((617573.4 1818086,...
4  POLYGON ((615348.9 1816681,...
5  POLYGON ((576213 1816670, 5...
6  POLYGON ((614726.5 1815664,...
7  POLYGON ((567698.8 1812707,...
8  POLYGON ((567113.7 1811709,...
9  POLYGON ((566277.8 1812459,...
10 POLYGON ((566420.1 1812065,...

$d5000
Simple feature collection with 253 features and 6 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 261736.6 ymin: 1466378 xmax: 800995.8 ymax: 1826365
Projected CRS: WGS 84 / UTM zone 16N
First 10 features:
   ID               Area       dPC  dPCintra   dPCflux dPCconnector
1   1   173709.713 [m^2] 0.0000481 0.0000053 0.0000429   1.7929e-16
2   2  1665924.073 [m^2] 0.0011975 0.0004839 0.0007136   0.0000e+00
3   3  1031587.411 [m^2] 0.0007524 0.0001855 0.0005669   0.0000e+00
4   4   261747.202 [m^2] 0.0002356 0.0000119 0.0002237   0.0000e+00
5   5 12462507.334 [m^2] 0.0329954 0.0270796 0.0059159   0.0000e+00
6   6   401677.773 [m^2] 0.0003261 0.0000281 0.0002979   0.0000e+00
7   7  1390255.378 [m^2] 0.0040398 0.0003370 0.0037028   0.0000e+00
8   8    60142.550 [m^2] 0.0001580 0.0000006 0.0001574   0.0000e+00
9   9  1419086.185 [m^2] 0.0036052 0.0003511 0.0032541   0.0000e+00
10 10     2818.298 [m^2] 0.0000071 0.0000000 0.0000071   0.0000e+00
                         geometry
1  POLYGON ((623563.5 1825642,...
2  POLYGON ((613771.4 1818067,...
3  POLYGON ((617573.4 1818086,...
4  POLYGON ((615348.9 1816681,...
5  POLYGON ((576213 1816670, 5...
6  POLYGON ((614726.5 1815664,...
7  POLYGON ((567698.8 1812707,...
8  POLYGON ((567113.7 1811709,...
9  POLYGON ((566277.8 1812459,...
10 POLYGON ((566420.1 1812065,...

$d20000
Simple feature collection with 253 features and 6 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 261736.6 ymin: 1466378 xmax: 800995.8 ymax: 1826365
Projected CRS: WGS 84 / UTM zone 16N
First 10 features:
   ID               Area       dPC  dPCintra   dPCflux dPCconnector
1   1   173709.713 [m^2] 0.0002683 0.0000014 0.0002669  4.12761e-15
2   2  1665924.073 [m^2] 0.0033740 0.0001276 0.0032464  5.24750e-16
3   3  1031587.411 [m^2] 0.0020408 0.0000489 0.0019919  0.00000e+00
4   4   261747.202 [m^2] 0.0005575 0.0000032 0.0005543  2.66182e-15
5   5 12462507.334 [m^2] 0.0328655 0.0071430 0.0257225  8.39610e-16
6   6   401677.773 [m^2] 0.0008711 0.0000074 0.0008637  0.00000e+00
7   7  1390255.378 [m^2] 0.0043224 0.0000889 0.0042335  0.00000e+00
8   8    60142.550 [m^2] 0.0001911 0.0000002 0.0001910  1.33435e-15
9   9  1419086.185 [m^2] 0.0043491 0.0000926 0.0042565  0.00000e+00
10 10     2818.298 [m^2] 0.0000088 0.0000000 0.0000088  2.54845e-15
                         geometry
1  POLYGON ((623563.5 1825642,...
2  POLYGON ((613771.4 1818067,...
3  POLYGON ((617573.4 1818086,...
4  POLYGON ((615348.9 1816681,...
5  POLYGON ((576213 1816670, 5...
6  POLYGON ((614726.5 1815664,...
7  POLYGON ((567698.8 1812707,...
8  POLYGON ((567113.7 1811709,...
9  POLYGON ((566277.8 1812459,...
10 POLYGON ((566420.1 1812065,...</code></pre>
</div>
</div>
<ul>
<li><p>dPC: Valor total de conectividad asociado a ese parche. Este valor representa cuánto contribuye el parche a la conectividad total del paisaje. Parches con valores altos son más importantes para mantener la conectividad general.</p></li>
<li><p>dPCintra: Esta parte representa la conectividad interna, que depende del tamaño del parche. Si es igual al dPC, significa que el parche no está conectado a otros (o que la especie no puede moverse a otros parches dentro del umbral de distancia).</p></li>
<li><p>dPCflux: Representa el flujo de conectividad directa con otros parches. Si este valor es 0, el parche no tiene conexiones directas dentro del umbral de dispersión.</p></li>
<li><p>dPCconnector: Mide el valor del parche como puente entre otros. Un valor alto indica que el parche sirve como paso intermedio para conectar otros parches que de otra forma estarían aislados.</p></li>
</ul>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>El paquete grainscape permite modelar y visualizar la conectividad del paisaje mediante redes espaciales explícitas, basadas en grafos. Esta herramienta resulta útil para analizar la fragmentación del hábitat, el movimiento de especies, la identificación de corredores ecológicos y el diseño de estrategias de conservación.</p>
<p>Un grafo es una estructura matemática que se utiliza para modelar relaciones o conexiones entre objetos. En términos simples, un grafo está compuesto por:</p>
<ul>
<li><p>Nodos (o vértices): representan los objetos o entidades (por ejemplo, parches de hábitat, ciudades, personas, etc.).</p></li>
<li><p>Aristas (o enlaces): representan las conexiones o relaciones entre los nodos (por ejemplo, caminos, ríos, rutas de dispersión, etc.).</p></li>
</ul>
<p><a href="https://doi.org/10.1111/2041-210X.13350">The r toolbox grainscape for modelling and visualizing landscape connectivity using spatially explicit networks</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grainscape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'grainscape'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:terra':

    distance</code></pre>
</div>
</div>
<p>Se utilizaran los límites administrativos de Honduras mediante la función gadm(), seleccionando el departamento de Francisco Morazán. Luego, esta capa se transforma al mismo sistema de coordenadas que la capa de bosque (BosqueMixto) y se recorta el área de estudio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>FM <span class="ot">&lt;-</span> <span class="fu">gadm</span>(<span class="st">"Honduras"</span>, <span class="at">level=</span> <span class="dv">1</span>, <span class="at">path =</span> <span class="fu">tempdir</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(BosqueMixto)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME_1 <span class="sc">==</span> <span class="st">"Francisco Morazán"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(FM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Conectividad_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>BosqueMixto_FM <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(BosqueMixto, FM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La capa vectorial del bosque recortada se convierte en un objeto SpatVector. A continuación, se genera una plantilla raster con una resolución espacial de 30 metros y se rasteriza la capa de bosque. En este proceso, las celdas correspondientes al bosque reciben el valor 1, mientras que las áreas no boscosas se asignan con el valor 1000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>BosqueMixto_vect <span class="ot">&lt;-</span> <span class="fu">vect</span>(BosqueMixto_FM)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>r_template <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">ext</span>(BosqueMixto_vect), <span class="at">resolution =</span> <span class="dv">30</span>, <span class="at">crs =</span> <span class="fu">crs</span>(BosqueMixto_vect))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(BosqueMixto_vect, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                                r_template, </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">field =</span> <span class="dv">1</span>, </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">background =</span> <span class="dv">1000</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BosqueMixto_raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Conectividad_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El raster se reclasifica para representar únicamente la presencia (1) y ausencia de bosque (0). Las celdas con valores NA se asignan como 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster[BosqueMixto_raster <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster[BosqueMixto_raster <span class="sc">==</span> <span class="dv">1000</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster[<span class="fu">is.na</span>(BosqueMixto_raster)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para simular variabilidad en la resistencia al movimiento dentro del hábitat boscoso, se generan valores aleatorios entre 0.5 y 1.5 para las celdas de bosque, representando diferentes niveles de facilidad de desplazamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster_resistencia <span class="ot">=</span> BosqueMixto_raster</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>mascara_bosque <span class="ot">&lt;-</span> BosqueMixto_raster_resistencia <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster_resistencia[mascara_bosque] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(mascara_bosque[], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">min =</span> <span class="fl">0.5</span>, <span class="at">max =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tanto el raster de resistencia como el raster de hábitat se convierten a objetos del paquete raster, compatibles con las funciones del paquete grainscape.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster_resistencia <span class="ot">&lt;-</span> <span class="fu">as</span>(BosqueMixto_raster_resistencia, <span class="st">"Raster"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>BosqueMixto_raster <span class="ot">&lt;-</span> <span class="fu">as</span>(BosqueMixto_raster, <span class="st">"Raster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se calcula el Minimum Planar Graph (MPG) utilizando los rasters de resistencia y de parches (bosques). Este grafo representa la conectividad estructural del paisaje, donde los nodos corresponden a parches de hábitat y los enlaces a las rutas de menor costo entre ellos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="ot">&lt;-</span> <span class="fu">MPG</span>(<span class="at">cost =</span> BosqueMixto_raster_resistencia, <span class="at">patch =</span> BosqueMixto_raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finalmente, se grafica el MPG utilizando la función plot() para visualizar la estructura de conectividad del paisaje en el área de estudio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg<span class="sc">@</span>mpgPlot, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Conectividad_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HN%20Cursos%20publicidad/HN%20Biology%20Inv%20large.jpg" class="img-fluid figure-img"></p>
<figcaption>HN Biology Investigation Academy</figcaption>
</figure>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>